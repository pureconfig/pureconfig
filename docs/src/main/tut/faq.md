## FAQ

### How can I use PureConfig with Spark 2.1.0 (problematic shapeless dependency)?

Apache Spark (specifically version 2.1.0) has a transitive dependency
on [shapeless](https://github.com/milessabin/shapeless) 2.0.0. This version is
too old to be used by PureConfig, making your Spark project fail when using
`spark-submit`. The solution is to shade, i.e. rename, the version of shapeless
used by PureConfig.

#### SBT

If you are using the [sbt-assembly](https://github.com/sbt/sbt-assembly) plugin
to create your JARs you
can [shade](https://github.com/sbt/sbt-assembly#shading) shapeless by
adding

```scala
assemblyShadeRules in assembly := Seq(ShadeRule.rename("shapeless.**" -> "new_shapeless.@1").inAll)
```

to your `assembly.sbt` file.

#### Maven

The [maven-shade-plugin](https://maven.apache.org/plugins/maven-shade-plugin/)
can shade shapeless by adding

```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-shade-plugin</artifactId>
    <version>3.0.0</version>
    <executions>
        <execution>
            <phase>package</phase>
            <goals>
                <goal>shade</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <createDependencyReducedPom>false</createDependencyReducedPom>
        <relocations>
            <relocation>
                <pattern>shapeless</pattern>
                <shadedPattern>shapelesspureconfig</shadedPattern>
            </relocation>
        </relocations>
    </configuration>
</plugin>
```

to your `pom.xml` file.

### How can I avoid displaying sensitive parts of my configuration, such as passwords, when I print the result of PureConfig?

Configuration commonly includes sensitive information, such as passwords or keys. Generally these values should not appear in logging.

Unfortunately this means that Scala's typically helpful behavior of generating transparent `toString` methods gets in the way. When a configuration is loaded into a `case class`, then the default `toString` generated by Scala will display sensitive information. This behavior is standard Scala and has nothing to do with PureConfig per se.

A solution we've seen address this concern is to wrap the sensitive field in an [`AnyVal` new type](https://docs.scala-lang.org/overviews/core/value-classes.html) which simply redefines `toString`. Please see the example below.

```tut:silent:book
case class Sensitive(value: String) extends AnyVal {
  override def toString: String = "MASKED"
}

case class SuperSecretConfig(
  username: String,
  password: Sensitive,
  apiKey: Sensitive

)

import com.typesafe.config.ConfigFactory.parseString
```

Then when we print out the `SuperSecretConfig` after loading it via PureConfig, the senstive values are masked.

```tut:book
val secret = pureconfig.loadConfigOrThrow[SuperSecretConfig](parseString(s"""{
  username: john.smith
  password: password123
  api-key: 8ef72f48-2143-48af-9573-3b519bbcb777
}"""))
```

But, of course, the values we need are still there:

```tut:book
secret.password.value 
secret.apiKey.value
``` 
